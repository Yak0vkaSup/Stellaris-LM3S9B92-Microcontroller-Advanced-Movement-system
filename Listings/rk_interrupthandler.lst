


ARM Macro Assembler    Page 1 


    1 00000000         
    2 00000000         ; see page 109
    3 00000000 E000E100 
                       EN0     EQU              0xE000E100  ; page 136-137 numb
                                                            er 13
    4 00000000 E000E104 
                       EN1     EQU              0xE000E104
    5 00000000         
    6 00000000 4002C000 
                       QEI0_BASE
                               EQU              0x4002C000  ; right
    7 00000000 4002D000 
                       QEI1_BASE
                               EQU              0x4002D000  ; left
    8 00000000         
    9 00000000 40025000 
                       GPIO_PORTF_BASE
                               EQU              0x40025000
   10 00000000 40007000 
                       GPIO_PORTD_BASE
                               EQU              0x40007000
   11 00000000         
   12 00000000 00000010 
                       LED1_BIT
                               EQU              0x10
   13 00000000 00000020 
                       LED2_BIT
                               EQU              0x20
   14 00000000         
   15 00000000 00000028 
                       QEIISC_OFFSET
                               EQU              0x028
   16 00000000 00000418 
                       GPIOMIS_OFFSET
                               EQU              0x418
   17 00000000 00000020 
                       QEIINTEN_OFFSET
                               EQU              0x020
   18 00000000 0000041C 
                       GPIOICR_OFFSET
                               EQU              0x41C
   19 00000000         
   20 00000000 00000008 
                       QEIPOS_OFFSET
                               EQU              0x008
   21 00000000 40028000 
                       PWM_BASE
                               EQU              0x040028000
   22 00000000 40028058 
                       PWM0CMPA
                               EQU              PWM_BASE+0x058
   23 00000000 40028098 
                       PWM1CMPA
                               EQU              PWM_BASE+0x098
   24 00000000         
   25 00000000                 AREA             |.text|, CODE, READONLY
   26 00000000                 ENTRY
   27 00000000         
   28 00000000                 EXPORT           INTERRUPT_INIT



ARM Macro Assembler    Page 2 


   29 00000000                 EXPORT           INTERRUPT_HANDLER_0
   30 00000000                 EXPORT           INTERRUPT_HANDLER_1
   31 00000000                 EXPORT           PORTD_INTERRUPT_HANDLER
   32 00000000                 IMPORT           main_loop
   33 00000000                 IMPORT           loop2
   34 00000000         
   35 00000000         INTERRUPT_INIT
   36 00000000         
   37 00000000 4E21            ldr              r6, = EN0
   38 00000002 F242 0008       mov              r0, #0x2008
   39 00000006 6030            str              r0, [r6]
   40 00000008         
   41 00000008 4E20            ldr              r6, = EN1
   42 0000000A F04F 0040       mov              r0, #0x40   ; 32 - 36 page 137
   43 0000000E 6030            str              r0, [r6]
   44 00000010         
   45 00000010         ;ldr r6, = QEI0_BASE+QEIINTEN_OFFSET
   46 00000010         ;mov r0, #0x2
   47 00000010         ;str r0, [r6]
   48 00000010         
   49 00000010 4E1F            ldr              r6, = QEI1_BASE+QEIINTEN_OFFSET
   50 00000012 F04F 0002       mov              r0, #0x2
   51 00000016 6030            str              r0, [r6]
   52 00000018         
   53 00000018         
   54 00000018 4770            BX               LR
   55 0000001A         
   56 0000001A         PORTD_INTERRUPT_HANDLER
   57 0000001A 491E            ldr              r1, = GPIO_PORTD_BASE + GPIOMIS
_OFFSET
   58 0000001C 6808            ldr              r0, [r1]
   59 0000001E         
   60 0000001E B128            cbz              r0, exit_portd_handler ; Exit i
                                                            f no interrupt is a
                                                            ctive
   61 00000020         
   62 00000020 F010 0F40       tst              r0, #0x40   ; Check PD6 
   63 00000024 D103            bne              handle_top_button
   64 00000026         
   65 00000026 F010 0F80       tst              r0, #0x80   ; Check PD7
   66 0000002A D10A            bne              handle_bottom_button
   67 0000002C         
   68 0000002C         exit_portd_handler
   69 0000002C 4770            bx               lr
   70 0000002E         
   71 0000002E         handle_top_button
   72 0000002E 4A1A            ldr              r2, = GPIO_PORTD_BASE + GPIOICR
_OFFSET
   73 00000030 F04F 0040       mov              r0, #0x40
   74 00000034 6010            str              r0, [r2]
   75 00000036         
   76 00000036 4B19            ldr              r3, = GPIO_PORTF_BASE + (LED1_B
IT << 2)
   77 00000038 6818            ldr              r0, [r3]
   78 0000003A F080 0010       eor              r0, r0, #LED1_BIT
   79 0000003E 6018            str              r0, [r3]
   80 00000040         
   81 00000040 E7F4            b                exit_portd_handler
   82 00000042         



ARM Macro Assembler    Page 3 


   83 00000042         handle_bottom_button
   84 00000042 4A15            ldr              r2, = GPIO_PORTD_BASE + GPIOICR
_OFFSET
   85 00000044 F04F 0080       mov              r0, #0x80
   86 00000048 6010            str              r0, [r2]
   87 0000004A         
   88 0000004A 4B14            ldr              r3, = GPIO_PORTF_BASE + (LED1_B
IT << 2)
   89 0000004C 6818            ldr              r0, [r3]
   90 0000004E F080 0010       eor              r0, r0, #LED1_BIT
   91 00000052 6018            str              r0, [r3]
   92 00000054         
   93 00000054 E7EA            b                exit_portd_handler
   94 00000056         
   95 00000056         
   96 00000056         INTERRUPT_HANDLER_0
   97 00000056         
   98 00000056 4912            ldr              r1, = QEI0_BASE+QEIISC_OFFSET
   99 00000058         ;nop
  100 00000058 6808            ldr              r0, [r1]    ;architecture defec
                                                            t, the execution is
                                                             faster than interr
                                                            upt that NVIC has n
                                                            o 
  101 0000005A         ;time to remove a flag and we add one additional reading
                        to fix that
  102 0000005A B138            cbz              r0, exit_handler_0 ; if r0 is 0
                                                            , so no flag we jus
                                                            t exit
  103 0000005C F04F 0002       mov              r0, #0x2
  104 00000060 6008            str              r0, [r1]
  105 00000062         
  106 00000062 4A0E            ldr              r2, =GPIO_PORTF_BASE + (LED1_BI
T << 2)
  107 00000064 6810            ldr              r0, [r2]
  108 00000066 F080 0010       eor              r0, r0, #LED1_BIT
  109 0000006A 6010            str              r0, [r2]
  110 0000006C         exit_handler_0
  111 0000006C 4770            BX               LR
  112 0000006E         
  113 0000006E         INTERRUPT_HANDLER_1
  114 0000006E 490D            ldr              r1, = QEI1_BASE+QEIISC_OFFSET
  115 00000070         ;nop
  116 00000070 6808            ldr              r0, [r1]    ;architecture defec
                                                            t, the execution is
                                                             faster than interr
                                                            upt that NVIC has n
                                                            o 
  117 00000072         ;time to remove a flag and we add one additional reading
                        to fix that*
  118 00000072 B138            cbz              r0, exit_handler_1
  119 00000074 F04F 0002       mov              r0, #0x2
  120 00000078 6008            str              r0, [r1]
  121 0000007A         
  122 0000007A 4B0B            ldr              r3, =GPIO_PORTF_BASE + (LED2_BI
T << 2)
  123 0000007C 6818            ldr              r0, [r3]
  124 0000007E F080 0020       eor              r0, r0, #LED2_BIT
  125 00000082 6018            str              r0, [r3]



ARM Macro Assembler    Page 4 


  126 00000084         exit_handler_1
  127 00000084 4770            BX               LR
  128 00000086         
                       
              00 00 E000E100 
              E000E104 
              4002D020 
              40007418 
              4000741C 
              40025040 
              4002C028 
              4002D028 
              40025080 
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M3 --apcs=interw
ork --depend=.\objects\rk_interrupthandler.d -o.\objects\rk_interrupthandler.o 
-I.\RTE\_Target_1 -IC:\Users\Yakov\AppData\Local\Arm\Packs\ARM\CMSIS\5.5.1\CMSI
S\Core\Include -IC:\Users\Yakov\AppData\Local\Arm\Packs\ARM\CMSIS\5.5.1\Device\
ARM\ARMCM3\Include --predefine="__EVAL SETA 1" --predefine="__MICROLIB SETA 1" 
--predefine="__UVISION_VERSION SETA 528" --predefine="_RTE_ SETA 1" --predefine
="ARMCM3 SETA 1" --list=.\listings\rk_interrupthandler.lst RK_InterruptHandler.
s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

.text 00000000

Symbol: .text
   Definitions
      At line 25 in file RK_InterruptHandler.s
   Uses
      None
Comment: .text unused
INTERRUPT_HANDLER_0 00000056

Symbol: INTERRUPT_HANDLER_0
   Definitions
      At line 96 in file RK_InterruptHandler.s
   Uses
      At line 29 in file RK_InterruptHandler.s
Comment: INTERRUPT_HANDLER_0 used once
INTERRUPT_HANDLER_1 0000006E

Symbol: INTERRUPT_HANDLER_1
   Definitions
      At line 113 in file RK_InterruptHandler.s
   Uses
      At line 30 in file RK_InterruptHandler.s
Comment: INTERRUPT_HANDLER_1 used once
INTERRUPT_INIT 00000000

Symbol: INTERRUPT_INIT
   Definitions
      At line 35 in file RK_InterruptHandler.s
   Uses
      At line 28 in file RK_InterruptHandler.s
Comment: INTERRUPT_INIT used once
PORTD_INTERRUPT_HANDLER 0000001A

Symbol: PORTD_INTERRUPT_HANDLER
   Definitions
      At line 56 in file RK_InterruptHandler.s
   Uses
      At line 31 in file RK_InterruptHandler.s
Comment: PORTD_INTERRUPT_HANDLER used once
exit_handler_0 0000006C

Symbol: exit_handler_0
   Definitions
      At line 110 in file RK_InterruptHandler.s
   Uses
      At line 102 in file RK_InterruptHandler.s
Comment: exit_handler_0 used once
exit_handler_1 00000084

Symbol: exit_handler_1
   Definitions
      At line 126 in file RK_InterruptHandler.s
   Uses
      At line 118 in file RK_InterruptHandler.s
Comment: exit_handler_1 used once
exit_portd_handler 0000002C

Symbol: exit_portd_handler



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 68 in file RK_InterruptHandler.s
   Uses
      At line 60 in file RK_InterruptHandler.s
      At line 81 in file RK_InterruptHandler.s
      At line 93 in file RK_InterruptHandler.s

handle_bottom_button 00000042

Symbol: handle_bottom_button
   Definitions
      At line 83 in file RK_InterruptHandler.s
   Uses
      At line 66 in file RK_InterruptHandler.s
Comment: handle_bottom_button used once
handle_top_button 0000002E

Symbol: handle_top_button
   Definitions
      At line 71 in file RK_InterruptHandler.s
   Uses
      At line 63 in file RK_InterruptHandler.s
Comment: handle_top_button used once
10 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

EN0 E000E100

Symbol: EN0
   Definitions
      At line 3 in file RK_InterruptHandler.s
   Uses
      At line 37 in file RK_InterruptHandler.s
Comment: EN0 used once
EN1 E000E104

Symbol: EN1
   Definitions
      At line 4 in file RK_InterruptHandler.s
   Uses
      At line 41 in file RK_InterruptHandler.s
Comment: EN1 used once
GPIOICR_OFFSET 0000041C

Symbol: GPIOICR_OFFSET
   Definitions
      At line 18 in file RK_InterruptHandler.s
   Uses
      At line 72 in file RK_InterruptHandler.s
      At line 84 in file RK_InterruptHandler.s

GPIOMIS_OFFSET 00000418

Symbol: GPIOMIS_OFFSET
   Definitions
      At line 16 in file RK_InterruptHandler.s
   Uses
      At line 57 in file RK_InterruptHandler.s
Comment: GPIOMIS_OFFSET used once
GPIO_PORTD_BASE 40007000

Symbol: GPIO_PORTD_BASE
   Definitions
      At line 10 in file RK_InterruptHandler.s
   Uses
      At line 57 in file RK_InterruptHandler.s
      At line 72 in file RK_InterruptHandler.s
      At line 84 in file RK_InterruptHandler.s

GPIO_PORTF_BASE 40025000

Symbol: GPIO_PORTF_BASE
   Definitions
      At line 9 in file RK_InterruptHandler.s
   Uses
      At line 76 in file RK_InterruptHandler.s
      At line 88 in file RK_InterruptHandler.s
      At line 106 in file RK_InterruptHandler.s
      At line 122 in file RK_InterruptHandler.s

LED1_BIT 00000010

Symbol: LED1_BIT
   Definitions
      At line 12 in file RK_InterruptHandler.s



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols

   Uses
      At line 76 in file RK_InterruptHandler.s
      At line 78 in file RK_InterruptHandler.s
      At line 88 in file RK_InterruptHandler.s
      At line 90 in file RK_InterruptHandler.s
      At line 106 in file RK_InterruptHandler.s
      At line 108 in file RK_InterruptHandler.s

LED2_BIT 00000020

Symbol: LED2_BIT
   Definitions
      At line 13 in file RK_InterruptHandler.s
   Uses
      At line 122 in file RK_InterruptHandler.s
      At line 124 in file RK_InterruptHandler.s

PWM0CMPA 40028058

Symbol: PWM0CMPA
   Definitions
      At line 22 in file RK_InterruptHandler.s
   Uses
      None
Comment: PWM0CMPA unused
PWM1CMPA 40028098

Symbol: PWM1CMPA
   Definitions
      At line 23 in file RK_InterruptHandler.s
   Uses
      None
Comment: PWM1CMPA unused
PWM_BASE 40028000

Symbol: PWM_BASE
   Definitions
      At line 21 in file RK_InterruptHandler.s
   Uses
      At line 22 in file RK_InterruptHandler.s
      At line 23 in file RK_InterruptHandler.s

QEI0_BASE 4002C000

Symbol: QEI0_BASE
   Definitions
      At line 6 in file RK_InterruptHandler.s
   Uses
      At line 98 in file RK_InterruptHandler.s
Comment: QEI0_BASE used once
QEI1_BASE 4002D000

Symbol: QEI1_BASE
   Definitions
      At line 7 in file RK_InterruptHandler.s
   Uses
      At line 49 in file RK_InterruptHandler.s
      At line 114 in file RK_InterruptHandler.s




ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Absolute symbols

QEIINTEN_OFFSET 00000020

Symbol: QEIINTEN_OFFSET
   Definitions
      At line 17 in file RK_InterruptHandler.s
   Uses
      At line 49 in file RK_InterruptHandler.s
Comment: QEIINTEN_OFFSET used once
QEIISC_OFFSET 00000028

Symbol: QEIISC_OFFSET
   Definitions
      At line 15 in file RK_InterruptHandler.s
   Uses
      At line 98 in file RK_InterruptHandler.s
      At line 114 in file RK_InterruptHandler.s

QEIPOS_OFFSET 00000008

Symbol: QEIPOS_OFFSET
   Definitions
      At line 20 in file RK_InterruptHandler.s
   Uses
      None
Comment: QEIPOS_OFFSET unused
16 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

loop2 00000000

Symbol: loop2
   Definitions
      At line 33 in file RK_InterruptHandler.s
   Uses
      None
Comment: loop2 unused
main_loop 00000000

Symbol: main_loop
   Definitions
      At line 32 in file RK_InterruptHandler.s
   Uses
      None
Comment: main_loop unused
2 symbols
365 symbols in table
